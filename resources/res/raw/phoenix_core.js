AlipayJSBridge=PaytmJSBridge=JSBridge=function(){var a={},b="v1.0.1",c={phoenixInilizing:"INITIALIZING_PHOENIX_JS "+b,phoenixInilized:"PHOENIX_JS "+b+"_INITIALIZED",noResponseId:"callbackId_DOESNOT_EXIST",noCallback:"Callback DOESNOT_EXIST",bridgeReadyEvents:["JSBridgeReady","PaytmJSBridgeReady","AlipayJSBridgeReady"]},d={getMobileOS:function getMobileOS(){var a=window.navigator.userAgent,b=window.navigator.platform,c=null;return-1===["iPhone","iPad","iPod"].indexOf(b)?/Android/.test(a)&&(c="Android"):c="iOS",c},bridgeRequest:function bridgeRequest(b){var c=b.bridgeName,e=b.params,f=b.callback,g=b.msgType,h=b.callbackId;c&&c.constructor===String?(e&&e.constructor===Function?(f=e,e=null):e&&e.constructor!==Object&&(e=null),f&&f.constructor===Function&&(a[h]=f),d.messageLogger({bridgeName:c,params:e,msgType:g,callbackId:h})):d.messageLogger("Bridge name invalid type!")},messageLogger:function messageLogger(a,b){if(Object.prototype.hasOwnProperty.call(a,"bridgeName")){var c=JSON.stringify(a),e=d.getMobileOS();if(console.log("{\"messageLogger\" : { \"OS\": \""+e+"\", \"message\": "+c+" }}"),"iOS"===e)try{webkit.messageHandlers.callback.postMessage(JSON.parse(c))}catch(a){console.error("Bridge calling failed IOS!",a)}else if("Android"===e)try{PhoenixNativeBridge.postMessage(c)}catch(a){console.error("Bridge calling failed Android!",a)}}else"info"===b?console.log("{\"messageLogger\" : \""+a+"\"}"):"warn"===b?console.warn("{\"messageLogger\" : \""+a+"\"}"):console.error("{\"messageLogger\" : \""+a+"\"}")},subscribe:function subscribe(a,b,c){d.bridgeRequest({bridgeName:a,params:b,callback:c,msgType:"subscribe",callbackId:a})},call:function call(a,b,c){var e=a+"_"+new Date().getTime()+Math.random();d.bridgeRequest({bridgeName:a,params:b,callback:c,msgType:"call",callbackId:e})},unsubscribe:function unsubscribe(a,b,c){d.bridgeRequest({bridgeName:a,params:b,callback:c,msgType:"unsubscribe",callbackId:a})},isSubscribed:function isSubscribed(b){return!!Object.prototype.hasOwnProperty.call(a,b)},invokeJS:function invokeJS(b){b=b&&b.constructor===String?JSON.parse(b):b;var f=b.responseData&&b.responseData.constructor===String?JSON.parse(b.responseData):b.responseData;if(b.msgType&&"internal"===b.msgType&&b.bridgeName)switch(b.bridgeName){case"startupParams":for(var g,h=0;h<c.bridgeReadyEvents.length;h++)g=c.bridgeReadyEvents[h],window[g.substr(0,g.length-5)].startupParams=f;}else{var j=a[b.callbackId];if(!j)return void d.messageLogger(c.noCallback);b.keepCallback||b.keepCallback.constructor!==Boolean||delete a[b.callbackId],j&&j.constructor===Function&&j(f)}},readyEvent:function readyEvent(a){return function(){var b=document.createEvent("Events");b.initEvent(a,!1,!1),setTimeout(function(){document.dispatchEvent(b)},1)}},onDOMReady:function onDOMReady(a){var b=/complete|loaded|interactive/;b.test(document.readyState)?a():document.defaultView.addEventListener("DOMContentLoaded",function(){a()},!1)},init:function init(){d.messageLogger(c.phoenixInilizing,"info");for(var a=0;a<c.bridgeReadyEvents.length;a++)d.onDOMReady(d.readyEvent(c.bridgeReadyEvents[a]));d.messageLogger(c.phoenixInilized,"info"),setTimeout(function(){var a=document.addEventListener;document.addEventListener=function(b,d){if(-1!==c.bridgeReadyEvents.indexOf(b)){var e=document.createEvent("Events");e.initEvent(b,!1,!1),d(e)}else a.apply(document,arguments)}},1)}};return d.init(),{call:d.call,postMessage:d.call,invokeJS:d.invokeJS,subscribe:d.subscribe,unsubscribe:d.unsubscribe,isSubscribed:d.isSubscribed}}();